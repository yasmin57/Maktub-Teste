CREATE SCHEMA `dbmaktub_teste` ;

CREATE TABLE `dbmaktub_teste`.`tblplano` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `operadora` VARCHAR(3000) NOT NULL,
  `reembolso` INT NOT NULL,
  `foto` VARCHAR(3000) NULL,
  `preco_base` FLOAT NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `dbmaktub_teste`.`tblmodalidade` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(3000) NOT NULL,
  `percentual` INT NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `dbmaktub_teste`.`tblplano_modalidade` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `idplano` INT NOT NULL,
  `idmodalidade` INT NOT NULL,
  PRIMARY KEY (`id`));

insert into tblplano (operadora, reembolso, preco_base) values ('Bradesco Saúde', 15, 100), ('Notre Dame Intermédica', 20, 120), ('Unimed', 17, 110), ('Amil', 25, 130), ('Sul América', 15, 115);

insert into tblmodalidade (nome, percentual) values ('Enfermaria', 10), ('Apartamento', 20);

alter table tblplano_modalidade add foreign key (idplano) references tblplano (id);

alter table tblplano_modalidade add foreign key (idmodalidade) references tblmodalidade (id);

insert into tblplano_modalidade (idplano, idmodalidade) values(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (4, 2), (5, 1);

CREATE TABLE `dbmaktub_teste`.`tblcliente` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nome_completo` VARCHAR(3000) NOT NULL,
  `tipo_cnpj` VARCHAR(45) NOT NULL,
  `tipo_contato` VARCHAR(45) NOT NULL,
  `telefone` VARCHAR(15) NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `dbmaktub_teste`.`tblcliente_plano` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `idcliente` INT NOT NULL,
  `idplano` INT NOT NULL,
  PRIMARY KEY (`id`));

alter table tblcliente_plano add foreign key (idplano) references tblplano(id);
alter table tblcliente_plano add foreign key (idcliente) references tblcliente(id);

CREATE TABLE `dbmaktub_teste`.`tblcontato` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(3000) NOT NULL,
  `telefone` VARCHAR(15) NOT NULL,
  `email` TEXT NULL,
  `mensagem` TEXT(5000) NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `dbmaktub_teste`.`tblsuporte` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `idtopico` INT NOT NULL,
  `pergunta` VARCHAR(3000) NOT NULL,
  `resposta` VARCHAR(3000) NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `dbmaktub_teste`.`tbltopico` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `topico` VARCHAR(3000) NOT NULL,
  PRIMARY KEY (`id`));

alter table tblsuporte add foreign key (idtopico) references tbltopico (id);

insert into tbltopico (topico) values('PAGAMENTO'), ('TIPO DE SEGURO'), ('MODALIDADE'), ('OPERADORA');
insert into tbltopico (topico) values('REEMBOLSO'), ('REGIÃO'), ('SITEMA');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES 
(1, 'Quais são as formas de pagamento?', 'Você pode efetuar o pagamento por boleto ou cartão de crédito.'),
(1, 'Como funciona o pagamento?', 'Após o corretor entrar em contato e os detalhes forem acertados, o cliente deve efetuar o pagamento. Quando a empresa receber, o plano estará disponível.'),
(1, 'Quantos dias úteis demora para confirmar o pagamento?', 'Caso o cliente pague pelo boleto, o prazo é de até 3 dias úteis. Caso contrário, o prazo é de 2 dias úteis.'),
(1, 'Quais cartões a empresa aceita?', 'Nós aceitamos VISA, MASTERCARD, ELO, AMERICAN EXPRESS, HIPERCARD E JCB.'),
(1, 'Quais são os descontos?', 'Não oferecemos descontos.');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES 
(2, 'Vocês vendem seguros de veículos?', 'No momento só trabalhamos com seguros de saúde, mas temos como objetivo cobrir toda a área de seguros num futuro próximo.');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES 
(3, 'Quais são as modalidades?', 
'Os planos possuem as modalidades Enfermaria e/ou Apartamento.'),
(3, 'Qual a diferença das modalidades?', 
'A modalidade Apartamento possui x, x e x, e a modalidade Enfermaria possui y, y e y.');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES 
(4, 'Quais são as operadoras?', 
'No momento trabalhamos com as operadoras: Notre Dame Intermédica, Bradesco Saúde, Unimed, Amil e Sul América.'),
(4, 'O que é uma operadora?', 
'É uma empresa que disponibiliza planos de saúde.'), 
(4, 'Como escolher uma operadora?', 
'Faça uma simulação e aguarde o corretor entrar em contato, ele explicará todas diferenças.'),
(4, 'Quais as diferenças entre as operadoras?', 
'As principais diferenças entre as operadoras são:
 Notre Dame Intermédica: xxxxxxxx;
 Bradesco Saúde: yyyyyyyyyy;
 Unimed: jjjjjjjjjjj;
 Amil: hhhhhhhhhhh;
 Sul América: dddddddddd;
.');

update tbltopico  set topico = "SEGURO" where id = 2;
update tbltopico  set topico = "CONTATO" where id = 7;

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES (5, 'Como requisitar o reembolso?', 'Mande um email para: maktubseguros@gmail.com ou entre em contato com o corretor'),
(5, 'Não recebi o reembolso. Como proceder?', 'A maktub lamenta o ocorrido e pede para que o cliente entre em contato com a operadora');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES (6, 'Quais regiões vocês atendem?', 'Nós estamos em SP, MG e RJ'),
(6, 'Contratei o serviço mas minha empresa mudou de cidade. Como proceder?', 'O plano continua disponível, no entanto pedimos que entre em contato com a maktub informando o novo endereço');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES (7, 'Como entrar em contato com a maktub?', 'Mande um email para maktubseguros@gmail.com, ligue para (11) 3619-3309 ou preencha o formulário na página contato'),
(7, 'O que fazer quando o corretor não entrou em contato?', 'Lamentamos o ocorrido. O cliente deve entrar em contato com a maktub pelo email da empresa ou pelo formulário na página de contatos.');

insert into tbltopico (topico) values ('CANCELAMENTO'), ('FUNCIONAMENTO') ;

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES (8, 'Como cancelar um plano?', 'Mande um email para maktubseguros@gmail.com, ligue para (11) 3619-3309 ou entre em contato com o corretor.'),
(8,'Como cancelar o pedido de cancelamento', 'Mande um email para maktubseguros@gmail.com, ligue para (11) 3619-3309 ou entre em contato com o corretor.');

INSERT INTO tblsuporte (idtopico, pergunta, resposta)
VALUES (9, 'Como faço para contratar um plano?', 'Faça uma simulação na tela home e escolha um plano.'),
(9,'O que devo fazer após a simulação?', 'O cliente deve aguardar o contato com o corretor.');

ALTER TABLE `dbmaktub_teste`.`tblcliente` 
CHANGE COLUMN `telefone` `celular` VARCHAR(16) NOT NULL ;
ALTER TABLE `dbmaktub_teste`.`tblcliente` 
ADD COLUMN `telefone` VARCHAR(15) NULL AFTER `celular`;

ALTER TABLE `dbmaktub_teste`.`tblcliente_plano` 
ADD COLUMN `preço` FLOAT NULL AFTER `idplano`;

CREATE TABLE `dbmaktub_teste`.`tbltipo_cnpj` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `sigla` VARCHAR(1000) NOT NULL,
  PRIMARY KEY (`id`));

insert into tbltipo_cnpj (sigla) values ('MEI'), ('ME'), ('LTDA'), ('EI'), ('EP'), ('EIRELI'), ('S.A');

ALTER TABLE `dbmaktub_teste`.`tblcliente` 
CHANGE COLUMN `tipo_cnpj` `idtipo_cnpj` VARCHAR(45) NOT NULL ;

ALTER TABLE `dbmaktub_teste`.`tblcliente` 
CHANGE COLUMN `idtipo_cnpj` `idtipo_cnpj` INT NOT NULL ;

alter table tblcliente add foreign key (idtipo_cnpj) references tbltipo_cnpj (id);

update tblsuporte set pergunta='Quais são os tipos de seguro que a Maktub trabalha?' where id = 6;